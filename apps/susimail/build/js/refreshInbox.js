const form=document.querySelector('form[action="/susimail/"]'),mailboxControls=document.getElementById("mailboxcontrols"),mailbox=document.getElementById("mailbox"),notify=document.getElementById("notify"),pageRefresh=document.getElementById("pageRefresh"),serverRefresh=document.getElementById("serverRefresh");if(notify&&setTimeout(()=>{notify.remove()},4e3),mailbox&&pageRefresh){removeDupeNotices();const interval=setInterval(()=>{document.getElementById("serverRefresh")?clearInterval(interval):(pageRefresh&&pageRefresh.classList.add("checking"),fetch("/susimail?"+(new Date).getTime()).then(response=>response.text()).then(html=>{var refresh=(html=(new DOMParser).parseFromString(html,"text/html")).getElementById("pageRefresh")||html.getElementById("serverRefresh"),newMailbox=html.getElementById("mailbox"),html=html.getElementById("notify");pageRefresh.outerHTML!==refresh.outerHTML&&(pageRefresh.outerHTML=refresh.outerHTML),mailbox.innerHTML!==newMailbox.innerHTML&&(mailbox.innerHTML=newMailbox.innerHTML),!html||notify.innerHTML===html.innerHTML&&notify||(notify&&notify.remove(),form.appendChild(html)),removeDupeNotices()}).catch(()=>{}))},5e3)}function removeDupeNotices(){var notices=document.querySelectorAll(".notifications");if(notices)for(let i=1;i<notices.length;i++){var toRemove=notices[i];toRemove.parentNode.removeChild(toRemove)}}