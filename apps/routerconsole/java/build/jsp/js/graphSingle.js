let graphImage;function initButtons(){document.addEventListener("click",function(event){if(event.target.closest("#graphopts a")){event.preventDefault();const href=event.target.getAttribute("href");fetch(href).then(response=>response.text()).then(data=>{(temp=document.createElement("div")).innerHTML=data;var data=temp.querySelector("#graphSingle").src,data=(graphImage.src=data,document.getElementById("graphopts")),temp=temp.querySelector("#graphopts").innerHTML;data.innerHTML=temp,history.pushState(null,"",href),initCss()}).catch(error=>console.error("Error updating graph: ",error))}})}function initCss(){setInterval(()=>injectCss(),500)}function injectCss(){graphImage||setTimeout(()=>{injectCss()},100);var graphWidth=graphImage.naturalWidth,graphcss=(graphImage.naturalHeight,document.getElementById("graphcss"));graphcss&&graphcss.remove(),(graphcss=document.createElement("style")).setAttribute("id","graphcss"),graphWidth=0!==graphWidth?graphWidth+4:graphImage.width+4,graphcss.innerHTML=".graphContainer{width:"+graphWidth+"px}",document.head.appendChild(graphcss)}function refreshGraph(){function updateGraphURL(){var graphURL=graphImage.src.replace(/time=\d+/,"time="+Date.now());graphImage.src=graphURL,graphImage.onload=function(){initCss()}}var graph;0<graphRefreshInterval&&(graph=document.getElementById("single"),graphImage=document.getElementById("graphSingle"),updateGraphURL(),graph)&&"visible"==document.visibilityState&&setInterval(function(){progressx.show("<%=theme%>"),updateGraphURL(),progressx.hide()},graphRefreshInterval)}document.addEventListener("DOMContentLoaded",()=>{graphImage=document.getElementById("graphSingle"),initButtons(),progressx.hide(),graphImage.onload=function(){initCss()},refreshGraph()});