import{refreshElements}from"/js/refreshElements.js";!function(){const REFRESH_INTERVAL=1e4,RETRY_DELAY=3e3;let main,peers,tunnels,refreshBtn,sorter=null,isSetup=!1,isRefreshing=!1;function getDOM(){main||(main=document.getElementById("tunnels"),peers=document.getElementById("transitPeers"),tunnels=document.getElementById("allTransit"),refreshBtn=document.getElementById("refreshPage"))}function refreshData(){isRefreshing||(isRefreshing=!0,requestAnimationFrame(()=>progressx?.show?.(theme))),getDOM();var notes=document.querySelectorAll(".statusnotes");peers&&notes.length?(!isSetup&&tunnels&&(sorter=sorter||new Tablesort(tunnels,{descending:!0}),tunnels.addEventListener("beforeSort",()=>progressx.show(theme)),tunnels.addEventListener("afterSort",()=>progressx.hide()),refreshBtn&&refreshBtn.removeAttribute("href"),isSetup=!0),refreshElements(".statusnotes, #transitPeers","/transitfast",REFRESH_INTERVAL)):main&&refreshElements("#tunnels","/transitfast",RETRY_DELAY),requestAnimationFrame(()=>progressx?.hide?.()),isRefreshing=!1}function init(retryCount=0){getDOM(),refreshBtn?(refreshBtn.addEventListener("click",e=>{e.preventDefault(),refreshData()}),refreshData()):retryCount<30&&setTimeout(()=>init(retryCount+1),RETRY_DELAY)}document.addEventListener("refreshComplete",()=>{sorter&&sorter.refresh()}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>init()):init()}();